{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import{useNavigate}from\"react-router-dom\";import\"./styles/Login.css\";import API_BASE_URL from\"./config\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function Disposizioni(){const[file,setFile]=useState(null);const[title,setTitle]=useState(\"\");const[errore,setErrore]=useState(\"\");const navigate=useNavigate();useEffect(()=>{const token=localStorage.getItem(\"token\");const role=localStorage.getItem(\"role\");if(!token||role!==\"operatore_Dolomiti\"){navigate(\"/login\");}},[navigate]);const handleFileChange=e=>{const selectedFile=e.target.files[0];if(selectedFile&&selectedFile.type===\"application/pdf\"){setFile(selectedFile);}else{alert(\"Carica un file PDF valido.\");setFile(null);}};const handleRedirect=()=>{navigate(\"/interfacciaDA\");};const postDisposizione=async()=>{try{setErrore(\"\");if(!file||!title){setErrore(\"Inserisci sia il titolo che il file.\");return;}const token=localStorage.getItem(\"token\");const formData=new FormData();formData.append(\"file\",file);formData.append(\"title\",title);const response=await fetch(API_BASE_URL+\"/api/rifiuti/disposizioni\",{method:\"POST\",headers:{\"access-token\":token},body:formData});if(!response.ok)throw new Error(\"Errore durante l'upload della disposizione.\");alert(\"Disposizione caricata con successo!\");setFile(null);setTitle(\"\");}catch(error){setErrore(error.message);console.error(\"Errore nell'invio del file:\",error);}};const patchDisposizione=async()=>{try{setErrore(\"\");if(!file){setErrore(\"Seleziona un file per l'aggiornamento.\");return;}const token=localStorage.getItem(\"token\");const formData=new FormData();formData.append(\"file\",file);formData.append(\"title\",title);const response=await fetch(API_BASE_URL+\"/api/rifiuti/disposizioni\",{method:\"PATCH\",headers:{\"access-token\":token},body:formData});if(!response.ok){const errorData=await response.json();throw new Error(errorData.error||\"Errore durante l'aggiornamento della disposizione.\");}alert(\"Disposizione aggiornata con successo!\");setFile(null);}catch(error){setErrore(error.message);console.error(\"Errore nell'aggiornamento del file:\",error);}};const deleteDisposizione=async()=>{try{const conferma=window.confirm(\"Sei sicuro di voler eliminare la disposizione più vecchia?\");if(!conferma)return;const token=localStorage.getItem(\"token\");const response=await fetch(API_BASE_URL+\"/api/rifiuti/disposizioni\",{method:\"DELETE\",headers:{\"access-token\":token}});if(!response.ok){const errorData=await response.json();throw new Error(errorData.error||\"Errore durante l'eliminazione della disposizione.\");}alert(\"Disposizione eliminata con successo!\");}catch(error){setErrore(error.message);console.error(\"Errore nell'eliminazione del file:\",error);}};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"button\",{onClick:handleRedirect,className:\"back-button\",children:/*#__PURE__*/_jsx(\"img\",{src:\"https://cdn-icons-png.flaticon.com/128/507/507257.png\",alt:\"Back to Interfaccia DA\",style:{width:\"30px\",height:\"30px\"}})}),/*#__PURE__*/_jsx(\"h1\",{className:\"fade-in\",children:\"Disposizioni\"}),/*#__PURE__*/_jsxs(\"form\",{id:\"reservation-form\",className:\"slide-in\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"title\",children:\"Titolo:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"title\",name:\"title\",value:title,onChange:e=>setTitle(e.target.value),required:true}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"file\",children:\"Upload PDF:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",id:\"file\",name:\"file\",accept:\"application/pdf\",onChange:handleFileChange,required:true}),/*#__PURE__*/_jsxs(\"div\",{className:\"button-group\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:postDisposizione,children:\"Crea Nuova\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:patchDisposizione,children:\"Aggiorna\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:deleteDisposizione,style:{backgroundColor:\"red\",color:\"white\"},children:\"Elimina\"})]}),errore&&/*#__PURE__*/_jsx(\"p\",{style:{color:\"red\"},children:errore})]})]});}export default Disposizioni;","map":{"version":3,"names":["React","useState","useEffect","useNavigate","API_BASE_URL","jsx","_jsx","jsxs","_jsxs","Disposizioni","file","setFile","title","setTitle","errore","setErrore","navigate","token","localStorage","getItem","role","handleFileChange","e","selectedFile","target","files","type","alert","handleRedirect","postDisposizione","formData","FormData","append","response","fetch","method","headers","body","ok","Error","error","message","console","patchDisposizione","errorData","json","deleteDisposizione","conferma","window","confirm","children","onClick","className","src","alt","style","width","height","id","htmlFor","name","value","onChange","required","accept","backgroundColor","color"],"sources":["/root/UNIVERSITA/Webapp-comune-di-Trento/app-react/src/Disposizioni.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport \"./styles/Login.css\";\r\nimport API_BASE_URL from \"./config\";\r\n\r\n\r\nfunction Disposizioni() {\r\n  const [file, setFile] = useState(null);\r\n  const [title, setTitle] = useState(\"\");\r\n  const [errore, setErrore] = useState(\"\");\r\n  const navigate = useNavigate();\r\n\r\n  useEffect(() => {\r\n    const token = localStorage.getItem(\"token\");\r\n    const role = localStorage.getItem(\"role\");\r\n\r\n    if (!token || role !== \"operatore_Dolomiti\") {\r\n      navigate(\"/login\");\r\n    }\r\n  }, [navigate]);\r\n\r\n  const handleFileChange = (e) => {\r\n    const selectedFile = e.target.files[0];\r\n    if (selectedFile && selectedFile.type === \"application/pdf\") {\r\n      setFile(selectedFile);\r\n    } else {\r\n      alert(\"Carica un file PDF valido.\");\r\n      setFile(null);\r\n    }\r\n  };\r\n\r\n  const handleRedirect = () => {\r\n    navigate(\"/interfacciaDA\");\r\n  };\r\n\r\n  const postDisposizione = async () => {\r\n    try {\r\n      setErrore(\"\");\r\n      if (!file || !title) {\r\n        setErrore(\"Inserisci sia il titolo che il file.\");\r\n        return;\r\n      }\r\n\r\n      const token = localStorage.getItem(\"token\");\r\n      const formData = new FormData();\r\n      formData.append(\"file\", file);\r\n      formData.append(\"title\", title); \r\n\r\n      const response = await fetch(API_BASE_URL + \"/api/rifiuti/disposizioni\", {\r\n        method: \"POST\",\r\n        headers: { \"access-token\": token },\r\n        body: formData,\r\n      });\r\n\r\n      if (!response.ok) throw new Error(\"Errore durante l'upload della disposizione.\");\r\n\r\n      alert(\"Disposizione caricata con successo!\");\r\n      setFile(null);\r\n      setTitle(\"\"); \r\n    } catch (error) {\r\n      setErrore(error.message);\r\n      console.error(\"Errore nell'invio del file:\", error);\r\n    }\r\n  };\r\n\r\n  const patchDisposizione = async () => {\r\n    try {\r\n      setErrore(\"\");\r\n      if (!file) {\r\n        setErrore(\"Seleziona un file per l'aggiornamento.\");\r\n        return;\r\n      }\r\n\r\n      const token = localStorage.getItem(\"token\");\r\n      const formData = new FormData();\r\n      formData.append(\"file\", file);\r\n      formData.append(\"title\", title); \r\n\r\n\r\n      const response = await fetch(API_BASE_URL + \"/api/rifiuti/disposizioni\", {\r\n        method: \"PATCH\",\r\n        headers: { \"access-token\": token },\r\n        body: formData,\r\n      });\r\n\r\n      if (!response.ok) {\r\n        const errorData = await response.json();\r\n        throw new Error(errorData.error || \"Errore durante l'aggiornamento della disposizione.\");\r\n      }\r\n\r\n      alert(\"Disposizione aggiornata con successo!\");\r\n      setFile(null);\r\n    } catch (error) {\r\n      setErrore(error.message);\r\n      console.error(\"Errore nell'aggiornamento del file:\", error);\r\n    }\r\n  };\r\n\r\n  const deleteDisposizione = async () => {\r\n    try {\r\n      const conferma = window.confirm(\"Sei sicuro di voler eliminare la disposizione più vecchia?\");\r\n      if (!conferma) return;\r\n\r\n      const token = localStorage.getItem(\"token\");\r\n\r\n      const response = await fetch(API_BASE_URL + \"/api/rifiuti/disposizioni\", {\r\n        method: \"DELETE\",\r\n        headers: { \"access-token\": token },\r\n      });\r\n\r\n      if (!response.ok) {\r\n        const errorData = await response.json();\r\n        throw new Error(errorData.error || \"Errore durante l'eliminazione della disposizione.\");\r\n      }\r\n\r\n      alert(\"Disposizione eliminata con successo!\");\r\n    } catch (error) {\r\n      setErrore(error.message);\r\n      console.error(\"Errore nell'eliminazione del file:\", error);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <button onClick={handleRedirect} className=\"back-button\">\r\n        <img\r\n          src=\"https://cdn-icons-png.flaticon.com/128/507/507257.png\"\r\n          alt=\"Back to Interfaccia DA\"\r\n          style={{ width: \"30px\", height: \"30px\" }}\r\n        />\r\n      </button>\r\n\r\n      <h1 className=\"fade-in\">Disposizioni</h1>\r\n      <form id=\"reservation-form\" className=\"slide-in\">\r\n        <label htmlFor=\"title\">Titolo:</label>\r\n        <input\r\n          type=\"text\"\r\n          id=\"title\"\r\n          name=\"title\"\r\n          value={title}\r\n          onChange={(e) => setTitle(e.target.value)}\r\n          required\r\n        />\r\n\r\n        <label htmlFor=\"file\">Upload PDF:</label>\r\n        <input\r\n          type=\"file\"\r\n          id=\"file\"\r\n          name=\"file\"\r\n          accept=\"application/pdf\"\r\n          onChange={handleFileChange}\r\n          required\r\n        />\r\n\r\n        <div className=\"button-group\">\r\n          <button type=\"button\" onClick={postDisposizione}>Crea Nuova</button>\r\n          <button type=\"button\" onClick={patchDisposizione}>Aggiorna</button>\r\n          <button type=\"button\" onClick={deleteDisposizione} style={{ backgroundColor: \"red\", color: \"white\" }}>\r\n            Elimina\r\n          </button>\r\n        </div>\r\n\r\n        {errore && <p style={{ color: \"red\" }}>{errore}</p>}\r\n      </form>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Disposizioni;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
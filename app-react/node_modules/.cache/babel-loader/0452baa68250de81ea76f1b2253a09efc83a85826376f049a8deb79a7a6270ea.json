{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import{useNavigate}from\"react-router-dom\";import\"./styles/Login.css\";import API_BASE_URL from\"./config\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function Calendari(){const[zona,setZona]=useState(\"\");const[file,setFile]=useState(null);const[errore,setErrore]=useState(\"\");const navigate=useNavigate();useEffect(()=>{const token=localStorage.getItem(\"token\");const role=localStorage.getItem(\"role\");if(!token||role!==\"operatore_Dolomiti\"){navigate(\"/login\");}},[navigate]);const handleFileChange=e=>{setFile(e.target.files[0]);};const handleRedirect=()=>{navigate('/interfacciaDA');};const postCalendario=async()=>{try{setErrore(\"\");if(!file||!zona){setErrore(\"Compila tutti i campi!\");return;}const token=localStorage.getItem(\"token\");const formData=new FormData();formData.append(\"file\",file);const response=await fetch(API_BASE_URL+\"/api/rifiuti/calendari/\"+zona,{method:\"POST\",headers:{\"access-token\":token},body:formData});if(!response.ok)throw new Error(\"Errore durante l'upload del file\");alert(\"Calendario creato con successo!\");}catch(error){setErrore(error.message);console.error(\"Errore nell'invio del file:\",error);}};const patchCalendario=async()=>{try{setErrore(\"\");if(!file||!zona){setErrore(\"Compila tutti i campi!\");return;}const token=localStorage.getItem(\"token\");const formData=new FormData();formData.append(\"file\",file);const response=await fetch(API_BASE_URL+\"/api/rifiuti/calendari/\"+zona,{method:\"PATCH\",headers:{\"access-token\":token},body:formData});if(!response.ok){const errorData=await response.json();throw new Error(errorData.error||\"Errore durante l'aggiornamento del file\");}alert(\"Calendario aggiornato con successo!\");}catch(error){setErrore(error.message);console.error(\"Errore nell'aggiornamento del file:\",error);}};const deleteCalendario=async()=>{try{if(!zona){setErrore(\"Specifica una zona per eliminare il calendario!\");return;}const conferma=window.confirm(\"Sei sicuro di voler eliminare il calendario?\");if(!conferma)return;const token=localStorage.getItem(\"token\");const response=await fetch(API_BASE_URL+\"/api/rifiuti/calendari/\"+zona,{method:\"DELETE\",headers:{\"access-token\":token}});if(!response.ok){const errorData=await response.json();throw new Error(errorData.error||\"Errore durante l'eliminazione del file\");}alert(\"Calendario eliminato con successo!\");setZona(\"\");}catch(error){setErrore(error.message);console.error(\"Errore nell'eliminazione del file:\",error);}};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"button\",{onClick:handleRedirect,className:\"back-button\",children:/*#__PURE__*/_jsx(\"img\",{src:\"https://cdn-icons-png.flaticon.com/128/507/507257.png\",alt:\"Back to Interfaccia DA\",style:{width:\"30px\",height:\"30px\"}})}),/*#__PURE__*/_jsx(\"h1\",{className:\"fade-in\",children:\"Calendari\"}),/*#__PURE__*/_jsxs(\"form\",{id:\"reservation-form\",className:\"slide-in\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"zona\",children:\"Zona:\"}),/*#__PURE__*/_jsx(\"textarea\",{id:\"zona\",name:\"zona\",value:zona,onChange:e=>setZona(e.target.value),required:true}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"file\",children:\"Upload PDF:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",id:\"file\",name:\"file\",accept:\"application/pdf\",onChange:handleFileChange,required:true}),/*#__PURE__*/_jsxs(\"div\",{className:\"button-group\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:postCalendario,children:\"Crea Nuovo\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:patchCalendario,children:\"Aggiorna\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:deleteCalendario,style:{backgroundColor:\"red\",color:\"white\"},children:\"Elimina\"})]}),errore&&/*#__PURE__*/_jsx(\"p\",{style:{color:\"red\"},children:errore})]})]});}export default Calendari;","map":{"version":3,"names":["React","useState","useEffect","useNavigate","API_BASE_URL","jsx","_jsx","jsxs","_jsxs","Calendari","zona","setZona","file","setFile","errore","setErrore","navigate","token","localStorage","getItem","role","handleFileChange","e","target","files","handleRedirect","postCalendario","formData","FormData","append","response","fetch","method","headers","body","ok","Error","alert","error","message","console","patchCalendario","errorData","json","deleteCalendario","conferma","window","confirm","children","onClick","className","src","alt","style","width","height","id","htmlFor","name","value","onChange","required","type","accept","backgroundColor","color"],"sources":["/root/UNIVERSITA/Webapp-comune-di-Trento/app-react/src/Calendari.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { useNavigate } from \"react-router-dom\"; \r\nimport \"./styles/Login.css\";\r\nimport API_BASE_URL from \"./config\";\r\n\r\nfunction Calendari() {\r\n  const [zona, setZona] = useState(\"\");\r\n  const [file, setFile] = useState(null);\r\n  const [errore, setErrore] = useState(\"\");\r\n  const navigate = useNavigate(); \r\n\r\n  useEffect(() => {\r\n    const token = localStorage.getItem(\"token\");\r\n    const role = localStorage.getItem(\"role\");\r\n\r\n    if (!token || role !== \"operatore_Dolomiti\") {\r\n      navigate(\"/login\");\r\n    }\r\n  }, [navigate]);\r\n\r\n  const handleFileChange = (e) => {\r\n    setFile(e.target.files[0]);\r\n  };\r\n\r\n  const handleRedirect = () => {\r\n    navigate('/interfacciaDA');\r\n  };\r\n\r\n  const postCalendario = async () => {\r\n    try {\r\n      setErrore(\"\");\r\n      if (!file || !zona) {\r\n        setErrore(\"Compila tutti i campi!\");\r\n        return;\r\n      }\r\n\r\n      const token = localStorage.getItem(\"token\");\r\n      const formData = new FormData();\r\n      formData.append(\"file\", file);\r\n\r\n      const response = await fetch(API_BASE_URL + \"/api/rifiuti/calendari/\" + zona, {\r\n        method: \"POST\",\r\n        headers: { \"access-token\": token },\r\n        body: formData,\r\n      });\r\n\r\n      if (!response.ok) throw new Error(\"Errore durante l'upload del file\");\r\n\r\n      alert(\"Calendario creato con successo!\");\r\n    } catch (error) {\r\n      setErrore(error.message);\r\n      console.error(\"Errore nell'invio del file:\", error);\r\n    }\r\n  };\r\n\r\n  const patchCalendario = async () => {\r\n    try {\r\n      setErrore(\"\");\r\n      if (!file || !zona) {\r\n        setErrore(\"Compila tutti i campi!\");\r\n        return;\r\n      }\r\n\r\n      const token = localStorage.getItem(\"token\");\r\n      const formData = new FormData();\r\n      formData.append(\"file\", file);\r\n\r\n      const response = await fetch(API_BASE_URL + \"/api/rifiuti/calendari/\" + zona, {\r\n        method: \"PATCH\",\r\n        headers: { \"access-token\": token },\r\n        body: formData,\r\n      });\r\n\r\n      if (!response.ok) {\r\n        const errorData = await response.json();\r\n        throw new Error(errorData.error || \"Errore durante l'aggiornamento del file\");\r\n      }\r\n\r\n      alert(\"Calendario aggiornato con successo!\");\r\n    } catch (error) {\r\n      setErrore(error.message);\r\n      console.error(\"Errore nell'aggiornamento del file:\", error);\r\n    }\r\n  };\r\n\r\n  const deleteCalendario = async () => {\r\n    try {\r\n      if (!zona) {\r\n        setErrore(\"Specifica una zona per eliminare il calendario!\");\r\n        return;\r\n      }\r\n\r\n      const conferma = window.confirm(\"Sei sicuro di voler eliminare il calendario?\");\r\n      if (!conferma) return;\r\n\r\n      const token = localStorage.getItem(\"token\");\r\n\r\n      const response = await fetch(API_BASE_URL + \"/api/rifiuti/calendari/\" + zona, {\r\n        method: \"DELETE\",\r\n        headers: { \"access-token\": token },\r\n      });\r\n\r\n      if (!response.ok) {\r\n        const errorData = await response.json();\r\n        throw new Error(errorData.error || \"Errore durante l'eliminazione del file\");\r\n      }\r\n\r\n      alert(\"Calendario eliminato con successo!\");\r\n      setZona(\"\"); \r\n    } catch (error) {\r\n      setErrore(error.message);\r\n      console.error(\"Errore nell'eliminazione del file:\", error);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <button onClick={handleRedirect} className=\"back-button\">\r\n        <img\r\n          src=\"https://cdn-icons-png.flaticon.com/128/507/507257.png\"\r\n          alt=\"Back to Interfaccia DA\"\r\n          style={{ width: \"30px\", height: \"30px\" }}\r\n        />\r\n      </button>\r\n\r\n      <h1 className=\"fade-in\">Calendari</h1>\r\n      <form id=\"reservation-form\" className=\"slide-in\">\r\n        <label htmlFor=\"zona\">Zona:</label>\r\n        <textarea\r\n          id=\"zona\"\r\n          name=\"zona\"\r\n          value={zona}\r\n          onChange={(e) => setZona(e.target.value)}\r\n          required\r\n        />\r\n\r\n        <label htmlFor=\"file\">Upload PDF:</label>\r\n        <input\r\n          type=\"file\"\r\n          id=\"file\"\r\n          name=\"file\"\r\n          accept=\"application/pdf\"\r\n          onChange={handleFileChange}\r\n          required\r\n        />\r\n\r\n        <div className=\"button-group\">\r\n          <button type=\"button\" onClick={postCalendario}>Crea Nuovo</button>\r\n          <button type=\"button\" onClick={patchCalendario}>Aggiorna</button>\r\n          <button type=\"button\" onClick={deleteCalendario} style={{ backgroundColor: \"red\", color: \"white\" }}>\r\n            Elimina\r\n          </button>\r\n        </div>\r\n\r\n        {errore && <p style={{ color: \"red\" }}>{errore}</p>}\r\n      </form>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Calendari;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
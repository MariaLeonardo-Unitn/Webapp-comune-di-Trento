{"ast":null,"code":"import React,{useState}from'react';import'./styles/Login.css';import API_BASE_URL from\"./config\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function Login(){const[username,setUsername]=useState(\"\");const[password,setPassword]=useState(\"\");const[errorMessage,setErrorMessage]=useState(\"\");const handleSubmit=async event=>{event.preventDefault();setErrorMessage(\"\");const credentials={email:username,password:password};try{const response=await fetch(API_BASE_URL+\"/api/auth/login\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(credentials)});if(!response.ok){throw new Error(`Errore: ${response.status} ${response.statusText}`);}const data=await response.json();if(data.token){localStorage.setItem(\"token\",data.token);localStorage.setItem(\"role\",data.role);localStorage.setItem(\"utenteId\",data.utenteId);alert(\"Login effettuato con successo!\");if(data.role===\"operatore_Dolomiti\")window.location.href=\"/interfacciaDA\";if(data.role===\"operatore_comune\")window.location.href=\"/interfacciaC\";if(data.role===\"cittadino\")window.location.href=\"/menu\";}else throw new Error(\"Token non ricevuto\");}catch(error){console.error(\"Errore durante la richiesta:\",error);setErrorMessage(\"Credenziali errate o problema di connessione.\");}};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"fade-in\",children:\"Login\"}),errorMessage&&/*#__PURE__*/_jsx(\"p\",{style:{color:\"red\"},children:errorMessage}),/*#__PURE__*/_jsxs(\"form\",{id:\"login-form\",className:\"slide-in\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"username\",children:\"Username:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"username\",name:\"username\",value:username,onChange:e=>setUsername(e.target.value),required:true}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"password\",children:\"Password:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",id:\"password\",name:\"password\",value:password,onChange:e=>setPassword(e.target.value),required:true}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Invia\"})]})]});}export default Login;","map":{"version":3,"names":["React","useState","API_BASE_URL","jsx","_jsx","jsxs","_jsxs","Login","username","setUsername","password","setPassword","errorMessage","setErrorMessage","handleSubmit","event","preventDefault","credentials","email","response","fetch","method","headers","body","JSON","stringify","ok","Error","status","statusText","data","json","token","localStorage","setItem","role","utenteId","alert","window","location","href","error","console","children","className","style","color","id","onSubmit","htmlFor","type","name","value","onChange","e","target","required"],"sources":["/root/UNIVERSITA/Webapp-comune-di-Trento/app-react/src/Login.js"],"sourcesContent":["import React, { useState } from 'react';\r\nimport './styles/Login.css'; \r\nimport API_BASE_URL from \"./config\";\r\n\r\n\r\nfunction Login() {\r\n  const [username, setUsername] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n  const [errorMessage, setErrorMessage] = useState(\"\");\r\n\r\n  const handleSubmit = async (event) => {\r\n    event.preventDefault();\r\n    setErrorMessage(\"\"); \r\n\r\n    const credentials = { email: username, password: password };\r\n\r\n    try {\r\n      const response = await fetch(API_BASE_URL + \"/api/auth/login\", {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify(credentials),\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error(`Errore: ${response.status} ${response.statusText}`);\r\n      }\r\n\r\n      const data = await response.json(); \r\n\r\n      if (data.token) {\r\n        localStorage.setItem(\"token\", data.token);\r\n        localStorage.setItem(\"role\", data.role);\r\n        localStorage.setItem(\"utenteId\", data.utenteId);\r\n        alert(\"Login effettuato con successo!\");\r\n      \r\n        if (data.role === \"operatore_Dolomiti\") \r\n          window.location.href = \"/interfacciaDA\";\r\n        if (data.role === \"operatore_comune\") \r\n          window.location.href = \"/interfacciaC\";        \r\n        if (data.role === \"cittadino\") \r\n          window.location.href = \"/menu\";      \r\n      } else \r\n        throw new Error(\"Token non ricevuto\");\r\n    } catch (error) {\r\n      console.error(\"Errore durante la richiesta:\", error);\r\n      setErrorMessage(\"Credenziali errate o problema di connessione.\");\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <h1 className=\"fade-in\">Login</h1>\r\n      {errorMessage && <p style={{ color: \"red\" }}>{errorMessage}</p>}\r\n      <form id=\"login-form\" className=\"slide-in\" onSubmit={handleSubmit}>\r\n        <label htmlFor=\"username\">Username:</label>\r\n        <input\r\n          type=\"text\"\r\n          id=\"username\"\r\n          name=\"username\"\r\n          value={username}\r\n          onChange={(e) => setUsername(e.target.value)}\r\n          required\r\n        />\r\n\r\n        <label htmlFor=\"password\">Password:</label>\r\n        <input\r\n          type=\"password\"\r\n          id=\"password\"\r\n          name=\"password\"\r\n          value={password}\r\n          onChange={(e) => setPassword(e.target.value)}\r\n          required\r\n        />\r\n\r\n        <button type=\"submit\">Invia</button>\r\n      </form>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Login;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
{"ast":null,"code":"import React,{useState,useEffect}from'react';import{useNavigate}from'react-router-dom';import'./styles/Login.css';import API_BASE_URL from\"./config\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function CalendariUtente(){const[zona,setZona]=useState('');const navigate=useNavigate();const handleRedirect=()=>{navigate('/menu');};useEffect(()=>{const token=localStorage.getItem(\"token\");if(!token){navigate(\"/login\");}},[navigate]);const DownloadCalendari=async e=>{e.preventDefault();try{const token=localStorage.getItem(\"token\");if(!zona){alert(\"Inserisci una zona\");return;}const response=await fetch(API_BASE_URL+\"/api/rifiuti/calendari/\"+zona,{method:\"GET\",headers:{\"access-token\":token}});if(response.ok){const contentDisposition=response.headers.get('Content-Disposition');const filename=contentDisposition&&contentDisposition.split('filename=')[1];const blob=await response.blob();const link=document.createElement(\"a\");link.href=window.URL.createObjectURL(blob);link.download=filename||`calendario-${zona}.pdf`;link.click();}else{const errorData=await response.json();alert(errorData.error||\"Errore durante il download del calendario.\");}}catch(error){alert(\"Errore durante il download.\");console.error(error);}};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"button\",{onClick:handleRedirect,className:\"back-button\",children:/*#__PURE__*/_jsx(\"img\",{src:\"https://cdn-icons-png.flaticon.com/128/507/507257.png\",alt:\"Back to menu\",style:{width:'30px',height:'30px'}})}),/*#__PURE__*/_jsx(\"h1\",{className:\"fade-in\",children:\"Calendari\"}),/*#__PURE__*/_jsxs(\"form\",{id:\"reservation-form\",className:\"slide-in\",onSubmit:DownloadCalendari,children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"zona\",children:\"Zona:\"}),/*#__PURE__*/_jsx(\"textarea\",{id:\"zona\",name:\"zona\",value:zona,onChange:e=>setZona(e.target.value),required:true}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Invia\"})]})]});}export default CalendariUtente;","map":{"version":3,"names":["React","useState","useEffect","useNavigate","API_BASE_URL","jsx","_jsx","jsxs","_jsxs","CalendariUtente","zona","setZona","navigate","handleRedirect","token","localStorage","getItem","DownloadCalendari","e","preventDefault","alert","response","fetch","method","headers","ok","contentDisposition","get","filename","split","blob","link","document","createElement","href","window","URL","createObjectURL","download","click","errorData","json","error","console","children","onClick","className","src","alt","style","width","height","id","onSubmit","htmlFor","name","value","onChange","target","required","type"],"sources":["/root/UNIVERSITA/Webapp-comune-di-Trento/app-react/src/CalendariUtente.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom'; \nimport './styles/Login.css';\nimport API_BASE_URL from \"./config\";\n\n\nfunction CalendariUtente() {\n  const [zona, setZona] = useState('');\n  const navigate = useNavigate(); \n\n  const handleRedirect = () => {\n    navigate('/menu');\n  };\n\n  useEffect(() => {\n    const token = localStorage.getItem(\"token\");\n\n    if (!token) {\n      navigate(\"/login\");\n    }\n  }, [navigate]);\n\n  const DownloadCalendari = async (e) => {\n    e.preventDefault(); \n    try {\n      const token = localStorage.getItem(\"token\");\n      if (!zona) {\n        alert(\"Inserisci una zona\");\n        return;\n      }\n\n      const response = await fetch(API_BASE_URL + \"/api/rifiuti/calendari/\" + zona, {\n        method: \"GET\",\n        headers: {\n          \"access-token\": token,\n        },\n      });\n\n      if (response.ok) {\n        const contentDisposition = response.headers.get('Content-Disposition');\n        const filename = contentDisposition && contentDisposition.split('filename=')[1];\n\n        const blob = await response.blob();\n        const link = document.createElement(\"a\");\n        link.href = window.URL.createObjectURL(blob);\n        link.download = filename || `calendario-${zona}.pdf`; \n        link.click();\n      } else {\n        const errorData = await response.json();\n        alert(errorData.error || \"Errore durante il download del calendario.\");\n      }\n    } catch (error) {\n      alert(\"Errore durante il download.\");\n      console.error(error);\n    }\n  };\n\n  return (\n    <div>\n      <button onClick={handleRedirect} className=\"back-button\">\n        <img\n          src=\"https://cdn-icons-png.flaticon.com/128/507/507257.png\"\n          alt=\"Back to menu\"\n          style={{ width: '30px', height: '30px' }}\n        />\n      </button>\n\n      <h1 className=\"fade-in\">Calendari</h1>\n      <form id=\"reservation-form\" className=\"slide-in\" onSubmit={DownloadCalendari}>\n        <label htmlFor=\"zona\">Zona:</label>\n        <textarea\n          id=\"zona\"\n          name=\"zona\"\n          value={zona}\n          onChange={(e) => setZona(e.target.value)}\n          required\n        />\n\n        <button type=\"submit\">Invia</button>\n      </form>\n    </div>\n  );\n}\n\nexport default CalendariUtente;\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAClD,OAASC,WAAW,KAAQ,kBAAkB,CAC9C,MAAO,oBAAoB,CAC3B,MAAO,CAAAC,YAAY,KAAM,UAAU,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAGpC,QAAS,CAAAC,eAAeA,CAAA,CAAG,CACzB,KAAM,CAACC,IAAI,CAAEC,OAAO,CAAC,CAAGV,QAAQ,CAAC,EAAE,CAAC,CACpC,KAAM,CAAAW,QAAQ,CAAGT,WAAW,CAAC,CAAC,CAE9B,KAAM,CAAAU,cAAc,CAAGA,CAAA,GAAM,CAC3BD,QAAQ,CAAC,OAAO,CAAC,CACnB,CAAC,CAEDV,SAAS,CAAC,IAAM,CACd,KAAM,CAAAY,KAAK,CAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAE3C,GAAI,CAACF,KAAK,CAAE,CACVF,QAAQ,CAAC,QAAQ,CAAC,CACpB,CACF,CAAC,CAAE,CAACA,QAAQ,CAAC,CAAC,CAEd,KAAM,CAAAK,iBAAiB,CAAG,KAAO,CAAAC,CAAC,EAAK,CACrCA,CAAC,CAACC,cAAc,CAAC,CAAC,CAClB,GAAI,CACF,KAAM,CAAAL,KAAK,CAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAC3C,GAAI,CAACN,IAAI,CAAE,CACTU,KAAK,CAAC,oBAAoB,CAAC,CAC3B,OACF,CAEA,KAAM,CAAAC,QAAQ,CAAG,KAAM,CAAAC,KAAK,CAAClB,YAAY,CAAG,yBAAyB,CAAGM,IAAI,CAAE,CAC5Ea,MAAM,CAAE,KAAK,CACbC,OAAO,CAAE,CACP,cAAc,CAAEV,KAClB,CACF,CAAC,CAAC,CAEF,GAAIO,QAAQ,CAACI,EAAE,CAAE,CACf,KAAM,CAAAC,kBAAkB,CAAGL,QAAQ,CAACG,OAAO,CAACG,GAAG,CAAC,qBAAqB,CAAC,CACtE,KAAM,CAAAC,QAAQ,CAAGF,kBAAkB,EAAIA,kBAAkB,CAACG,KAAK,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,CAE/E,KAAM,CAAAC,IAAI,CAAG,KAAM,CAAAT,QAAQ,CAACS,IAAI,CAAC,CAAC,CAClC,KAAM,CAAAC,IAAI,CAAGC,QAAQ,CAACC,aAAa,CAAC,GAAG,CAAC,CACxCF,IAAI,CAACG,IAAI,CAAGC,MAAM,CAACC,GAAG,CAACC,eAAe,CAACP,IAAI,CAAC,CAC5CC,IAAI,CAACO,QAAQ,CAAGV,QAAQ,EAAI,cAAclB,IAAI,MAAM,CACpDqB,IAAI,CAACQ,KAAK,CAAC,CAAC,CACd,CAAC,IAAM,CACL,KAAM,CAAAC,SAAS,CAAG,KAAM,CAAAnB,QAAQ,CAACoB,IAAI,CAAC,CAAC,CACvCrB,KAAK,CAACoB,SAAS,CAACE,KAAK,EAAI,4CAA4C,CAAC,CACxE,CACF,CAAE,MAAOA,KAAK,CAAE,CACdtB,KAAK,CAAC,6BAA6B,CAAC,CACpCuB,OAAO,CAACD,KAAK,CAACA,KAAK,CAAC,CACtB,CACF,CAAC,CAED,mBACElC,KAAA,QAAAoC,QAAA,eACEtC,IAAA,WAAQuC,OAAO,CAAEhC,cAAe,CAACiC,SAAS,CAAC,aAAa,CAAAF,QAAA,cACtDtC,IAAA,QACEyC,GAAG,CAAC,uDAAuD,CAC3DC,GAAG,CAAC,cAAc,CAClBC,KAAK,CAAE,CAAEC,KAAK,CAAE,MAAM,CAAEC,MAAM,CAAE,MAAO,CAAE,CAC1C,CAAC,CACI,CAAC,cAET7C,IAAA,OAAIwC,SAAS,CAAC,SAAS,CAAAF,QAAA,CAAC,WAAS,CAAI,CAAC,cACtCpC,KAAA,SAAM4C,EAAE,CAAC,kBAAkB,CAACN,SAAS,CAAC,UAAU,CAACO,QAAQ,CAAEpC,iBAAkB,CAAA2B,QAAA,eAC3EtC,IAAA,UAAOgD,OAAO,CAAC,MAAM,CAAAV,QAAA,CAAC,OAAK,CAAO,CAAC,cACnCtC,IAAA,aACE8C,EAAE,CAAC,MAAM,CACTG,IAAI,CAAC,MAAM,CACXC,KAAK,CAAE9C,IAAK,CACZ+C,QAAQ,CAAGvC,CAAC,EAAKP,OAAO,CAACO,CAAC,CAACwC,MAAM,CAACF,KAAK,CAAE,CACzCG,QAAQ,MACT,CAAC,cAEFrD,IAAA,WAAQsD,IAAI,CAAC,QAAQ,CAAAhB,QAAA,CAAC,OAAK,CAAQ,CAAC,EAChC,CAAC,EACJ,CAAC,CAEV,CAEA,cAAe,CAAAnC,eAAe","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}